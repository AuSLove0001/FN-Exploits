PVOID(*CalculateSpread)(PVOID, float*, float*) = nullptr;
PVOID calculateSpreadCaller = nullptr;
float originalReloadTime = 0.0f;
PVOID(*GetWeaponStats)(PVOID) = nullptr;

PVOID CalculateSpreadHook(PVOID arg0, float* arg1, float* arg2) {
	if (originalReloadTime != 0.0f) {
		auto localPlayerWeapon = mem->read<uintptr_t>(LocalPawn, Offsets::CurrentWeapon);
		if (localPlayerWeapon) {
			auto stats = (GetWeaponStats, (PVOID)localPlayerWeapon);
			if (stats) {
				*reinterpret_cast<float*>(reinterpret_cast<PBYTE>(stats) + Offsets::ReloadTime) = originalReloadTime;
				originalReloadTime = 0.0f;
			}
		}
	}

	if (bNoSpread && _ReturnAddress() == calculateSpreadCaller) {
		return 0;
	}

	return (CalculateSpread, arg0, arg1, arg2);
}

void hookthisshit()
{
//I dont hav GWS sig 
  //addr = Scanners::PatternScan(xorthis("48 83 EC 58 48 8B 91 ? ? ? ? 48 85 D2 0F 84 ? ? ? ? F6 81 ? ? ? ? ? 74 10 48 8B 81 ? ? ? ? 48 85 C0 0F 85 ? ? ? ? 48 8B 8A ? ? ? ? 48 89 5C 24 ? 48 8D 9A ? ? ? ? 48 85 C9"));
	//GetWeaponStats = reinterpret_cast<decltype(GetWeaponStats)>(addr);

	addr = Scanners::PatternScan(xorthis("48 8B C4 48 89 58 18 55 56 57 41 54 41 55 41 56 41 57 48 8D A8 48 FE ? ? 48 81 EC ? ? ? ? 0F 29 70 B8 0F 29 78 A8 44 0F 29 40 ? 44 0F 29 48 ? 44 0F 29 90 ? ? ? ? 44 0F 29 98 ? ? ? ? 44 0F 29 A0 ? ? ?"));
	SpoofCall(DiscordHelper::InsertHook, addr, (uintptr_t)CalculateSpreadHook, (uintptr_t)&CalculateSpread);

	addr = Scanners::PatternScan(xorthis("0F 57 D2 48 8D 4C 24 ? 41 0F 28 CC E8 ? ? ? ? 48 8B 4D B0 0F 28 F0 48 85 C9")); //might be wrong
	calculateSpreadCaller = (PVOID)addr;
}
